
 SSH to EC2
chmod 400 devops-key.pem
ssh -i devops-key.pem ec2-user@<PUBLIC_IP>


 Linux User & Privilege Setup
sudo useradd devops
sudo passwd devops
sudo usermod -aG wheel devops

Verify:
id devops


 SSH Hardening
Edit SSH config:
sudo vi /etc/ssh/sshd_config

Ensure:
PermitRootLogin no
PasswordAuthentication no

Restart SSH:
sudo systemctl restart sshd


üîß AWS CLI Installation (Amazon Linux 2023)
sudo dnf install aws-cli -y

Verify:
aws --version


IAM Role Verification (NO CREDENTIALS)
aws sts get-caller-identity

Expected:
No aws configure
No access keys
ARN contains assumed-role

Failure Test (IAM Role)
Break:
Detach IAM role from EC2

Test:
aws sts get-caller-identity

Fix:
Reattach IAM role ‚Üí works again


DAY 1 ‚Äî INTERVIEW QUESTIONS & ANSWERS 

1. Why should root user not be used for daily work?
Answer:
Root has unrestricted access and cannot be limited by IAM policies. Best practice is to secure it with MFA and use IAM users for daily operations to reduce blast radius and meet compliance requirements.

2. IAM Role vs Access Keys ‚Äî what‚Äôs the difference?
Answer:
IAM roles provide temporary credentials via AWS STS and are assumed dynamically by services like EC2. Access keys are long-lived and risky if stored on servers, so we avoid them in production.

3. How does EC2 access AWS services securely?
Answer:
EC2 assumes an IAM role through the instance metadata service, which provides short-lived credentials automatically without storing secrets on the instance.

4. Why should SSH never be open to 0.0.0.0/0?
Answer:
Open SSH exposes instances to brute-force and credential-stuffing attacks. SSH access should be restricted to known IPs or routed through a bastion host.

5. How do you secure Linux access on EC2?
Answer:
We disable root login, disable password authentication, enforce key-based SSH, and grant sudo access only to required users.

6. What causes ‚ÄúUnable to locate credentials‚Äù on EC2?
Answer:
It usually means the EC2 instance does not have an IAM role attached or the role lacks required permissions. EC2 relies on the role for AWS authentication.

7. Why test failure by detaching the IAM role?
Answer:
Controlled failure testing validates assumptions and helps quickly identify root causes in production incidents related to permissions or automation failures.

8. Why is MFA mandatory for IAM users?
Answer:
MFA protects against credential compromise by adding a second authentication factor, which is required by most security standards and audits.

9. Why use Amazon Linux 2023?
Answer:
It‚Äôs AWS-maintained, security-hardened, integrates well with IAM and SSM, and receives long-term updates suitable for production workloads.


Use these naturally:
‚ÄúWe never store AWS credentials on servers.‚Äù
‚ÄúAll compute uses IAM roles with least privilege.‚Äù
‚ÄúRoot is break-glass only.‚Äù
‚ÄúSecurity groups follow deny-by-default.‚Äù
‚ÄúIf EC2 can‚Äôt assume a role, automation fails.‚Äù



sudo usermod -aG wheel devops
usermod	Modify an existing user
-a	Append (don‚Äôt overwrite existing groups)
-G	Add to supplementary group
wheel	Admin (sudo) group
devops	User being modified



sudo vi /etc/ssh/sshd_config
Configuration file for SSH daemon (sshd)
Controls: Who can log in, How they authenticate, Security rules
SSH reads this file on startup.

Disable root login
PermitRootLogin no
Why:
Root is a known username
Attackers target it first
Removes the most dangerous access path


Disable password authentication
PasswordAuthentication no
Why:
Passwords can be brute-forced
SSH keys are cryptographically stronger
Required for compliance

After changes: sudo systemctl restart sshd
Because: sshd only reads config at startup
No restart = no effect
